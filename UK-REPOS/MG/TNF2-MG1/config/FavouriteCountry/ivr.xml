<templateGroup name="FavouriteCountry">

	<template procedureName="DB_AddFavouriteCountry">
		<receiveTemplate>
			<Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="${guid}">
				<Item customer="${customer}">
					<Service id="#{document('C:\Foris\Messaging Gateway\config\Common\FavouriteCountry.xml')/favcountries/favcountry[@ivrcode='${favcountry}']/@crmcode}" action="2" needtariffication="0">
						<Attribute name="isparametricaldiscount" value="1" />
					</Service>
				</Item>
			</Message>
		</receiveTemplate>
		<input>
			<param name="customer" />
			<param name="favcountry" />
		</input>
		<output>
			<param name="dbresult" type="3" value="0" />
		</output>
	</template>

	<template procedureName="DB_GetFavouriteCountry">
		<receiveTemplate>
			<Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}" subject="get_parametrical_discount">
					<Attribute name="service_id" value="#{document('C:\Foris\Messaging Gateway\config\Common\FavouriteCountry.xml')/favcountries/favcountry[@ivrcode='${favouritecountry}']/@crmcode}" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="param:dbresult" value="${dbresult}"/>
			<set item="param:service_id" value="#{/Message/Item/row/Attribute[@name='service_id']/@value}"/>
			<set item="param:discount_counter" value="#{/Message/Item/row/Attribute[@name='discount_counter']/@value}"/>
			<set item="param:discount_type" value="#{/Message/Item/row/Attribute[@name='discount_type']/@value}"/>
			<set item="param:discount_value" value="#{/Message/Item/row/Attribute[@name='discount_value']/@value}"/>
			<set item="param:currency_code" value="#{/Message/Item/row/Attribute[@name='currency_code']/@value}"/>
		</deliveryTemplate>
		<input>
			<param name="customer" />
			<param name="favouritecountry" />
		</input>
		<output>
			<param name="dbresult" type="3" value="0" />
			<param name="service_id" type="1" value="" />
			<param name="discount_counter" type="1" value="" />
			<param name="discount_type" type="2" value="0" />
			<param name="discount_value" type="3" value="0" />
			<param name="currency_code" type="3" value="0" />
		</output>
	</template>

</templateGroup>