<templates connector="SOAP">
	#include "C:\FORIS\Messaging Gateway\config\FavouriteCountry\soap.xml"
	#include "C:\FORIS\Messaging Gateway\config\PoPTemplates\soap.xml"
	#include "C:\FORIS\Messaging Gateway\config\IVRPassword\soap.xml"
  	#include "C:\FORIS\Messaging Gateway\config\PoPTemplates\IvrSubTemplates.xml"
  	#include "C:\FORIS\Messaging Gateway\config\BundleEvents\ivr.xml"
  	#include "C:\FORIS\Messaging Gateway\config\get_bms_counters\ivr.xml"
	#include "C:\FORIS\Messaging Gateway\config\GuaranteedPayment\SOAP_USSD.xml"
	#include "C:\FORIS\Messaging Gateway\config\ServiceHandler\SOAP_USSD.xml"
	#include "C:\FORIS\Messaging Gateway\config\CallCentreNCC\NCC_CommonService.xml"
	#include "C:\FORIS\Messaging Gateway\config\CallCentreNCC\NCC_BMSService.xml"

	<macros>
		<define name="_SMSCON" value="SMSCON_04" />
		<define name="_BMSCON" value="WCFHND_01"/>
	</macros>
	
<template procedureName="TEST_time" >
	<receiveTemplate>
		<Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
			<Item customer="${msisdn}" subject="balance"/>
		</Message>
	</receiveTemplate>
	<deliveryTemplate direction="input" >
		<set item="oparam:result" value="#{getTimeInRange('09:30','19:30')}" />
	</deliveryTemplate>
	<input>
		<param name="msisdn" />
	</input>
	<output>
		<param name="result" value=""/>
	</output> 
</template>

<template procedureName="DB_GetCBLimit">
  <receiveTemplate>
    <Message type="GetDELimCounterRequest" initiator="ivrcon" id="${guid}" session_id="${guid}">
      <Item customer="${customer}" >
      </Item>
    </Message>
  </receiveTemplate>
  <deliveryTemplate direction="input" terminating="false">
    <set item="oparam:dbresult" value="0" />
  </deliveryTemplate>
  <deliveryTemplate connector="_SMSCON" />
  <input>
    <param name="Customer" />
  </input>
  <output>
    <param name="dbresult" />
  </output>
</template>



	<!--template procedureName="DB_AddRemoveService">
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${servicecode}" action="${serviceaction}" needtariffication="${needtariffication}" enddate="#{substring('${enddate}',1,10)} 23.59.59" informOnImpossibility="${informOnImpossibility}" sourcetypeid ="${sourcetypeid}" userid="${userid}" />
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate conditionEx="#{'${message}'=''}">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate conditionEx="#{'${message}'!=''}" terminating="false">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate connector="_SMSCON">
      <set item="Content" value="${message}" />
      <set item="Recipient" value="${customer}" />
    </deliveryTemplate>
    <input>
      <param name="customer" />
      <param name="servicecode" value="" />
      <param name="serviceaction" value="-1" />
      <param name="needtariffication" value="-1" /-->
	<!--param name="enddate" value="00.00.01 01.01.2099" /-->
	<!--param name="enddate"/>
      <param name="informOnImpossibility" value="-1" />
      <param name="sourcetypeid" value="-1" />
      <param name="userid" value="1" />
    </input>
    <output>
      <param name="RESULT" value="-1" />
    </output>
  </template-->

	<template procedureName="DB_SProcessing_TP" persistent="false">
		<condition>
		</condition>
		<receiveTemplate>
			<Message type="serviceorder" initiator="jrm" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
					<Service id="${service}" action="${action}" class="${class}" createrequest="1"/>
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate >
			<set item="oparam:dbresult" value="${dbresult}" />
			<set item="oparam:Subscription_status" value="${subscription}" />
			<set item="oparam:xActivate_status" value="${status}" />
			<set item="oparam:ISCharged" value="${ischarged}" />
			<set item="oparam:Price" value="${price}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
			<param name="service" />
			<param name="class" />
			<param name="action" />
		</input>
		<output>
			<param name="dbresult" type="3" value="0" /> 
			<param name="Subscription_status" type="2" value="0" />
			<param name="xActivate_status" type="2" value="0" />
			<param name="ISCharged" type="2" value="0" />
			<param name="price" type="2" value="0" />
		</output>
	</template>

	<template procedureName="DB_SProcessing" persistent="false">
		<condition>
		</condition>
		<receiveTemplate>
			<Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
					<Service id="${service}" action="${action}" class="${class}" createrequest="1"/>
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate >
			<set item="oparam:RESULT" value="${dbresult}" />
		</deliveryTemplate>

		<input>
			<param name="customer" />
			<param name="service" />
			<param name="class" />
			<param name="action" />
		</input>
		<output>
			<param name="RESULT" /> 
		</output>
	</template>

	<template procedureName='DB_ChangeTariff'>
		<receiveTemplate>
			<Message type="serviceorder" initiator="ivrcon" id='${guid}' session_id='@{newGuid}'>
				<Item customer='${customer}'>
					<Service id="changetariffplan" action="0" class='${newtariffplanid}' needtariffication='${needtariffication}' informOnImpossibility="0" sourcetypeid ='${sourcetypeid}' userid='${userid}' createrequest="1" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>            
			<set item='oparam:RESULT' value='${dbresult}' />            
		</deliveryTemplate>
		<input>
			<param name='customer' />
			<param name='newtariffplanid' />
			<param name='needtariffication' />
			<param name='sourcetypeid' />
			<param name='userid' />
		</input>
		<output>
			<param name='RESULT'/>
		</output>
	</template>

	<template procedureName='DB_CreditCorrection'>
		<receiveTemplate>
			<Message type="creditcorrection" initiator="ivrcon" id='${guid}' session_id='@{newGuid}'>
				<Item customer='${customer}'  operationtype ='${operationtype}' correctiontype='${correctiontype}' amount='${amount}' sourcetypeid ='${sourcetypeid}' userid='${userid}' />
			</Message>
		</receiveTemplate>
		<deliveryTemplate>            
			<set item='oparam:RESULT' value='${dbresult}' />            
		</deliveryTemplate>
		<input>
			<param name='customer' />
			<param name='operationtype' />
			<param name='correctiontype' />
			<param name='amount' />
			<param name='sourcetypeid' />
			<param name='userid' />
		</input>
		<output>
			<param name='RESULT'/>
		</output>
	</template>

	<!--template procedureName="DB_AddRemoveService">
    <receiveTemplate>
      <Message type="bundleprovision" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${servicecode}" action="#{if('${serviceaction}'='2','add',if('${serviceaction}'='3','remove',-1))}" needtariffication="1" enddate="#{if('${enddate}'='00.00.0001 01.01.01','01.01.0001 00.00.00',&apos;#{substring('${enddate}',1,10)} 23.59.59&apos;)}" informOnImpossibility="${informOnImpossibility}" sourcetypeid ="${sourcetypeid}" userid="${userid}" />
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate conditionEx="#{'${message}'=''}">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate conditionEx="#{'${message}'!=''}" terminating="false">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate connector="_SMSCON">
      <set item="Content" value="${message}" />
      <set item="Recipient" value="${customer}" />
    </deliveryTemplate>
    <input>
      <param name="customer" />
      <param name="servicecode" value="" />
      <param name="serviceaction" value="-1" />
      <param name="needtariffication" value="-1" />
	  <param name="enddate" value="00.00.01 01.01.2099"/>
      <param name="informOnImpossibility" value="-1" />
      <param name="sourcetypeid" value="1" />
      <param name="userid" value="1" />
    </input>
    <output>
      <param name="RESULT" value="-1" />
    </output>
  </template--> 

	<!--template procedureName="DB_AddRemoveService"  persistent="true">
    <receiveTemplate>
      <Message type="bundleprovision" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${servicecode}" action="#{if('${serviceaction}'='2','add',if('${serviceaction}'='3','remove',-1))}" needtariffication="1" enddate="${enddate}" informOnImpossibility="${informOnImpossibility}" sourcetypeid ="${sourcetypeid}" userid="${userid}" />
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate conditionEx="#{'${message}'=''}">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate conditionEx="#{'${message}'!=''}" terminating="false">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate connector="_SMSCON">
      <set item="Content" value="${message}" />
      <set item="Recipient" value="${customer}" />
    </deliveryTemplate>
    <input>
      <param name="customer" />
      <param name="servicecode" value="" />
      <param name="serviceaction" value="-1" />
      <param name="needtariffication" value="-1" />
	  <param name="enddate" value="00.00.01 01.01.2099"/>
      <param name="informOnImpossibility" value="-1" />
      <param name="sourcetypeid" value="1" />
      <param name="userid" value="1" />
    </input>
    <output>
      <param name="RESULT" value="-1" />
    </output>
  </template--> 

 <template procedureName="DB_AdditionalAgreementInformationSync" >
    <receiveTemplate>
      <Message type="additionalagreementinfo" initiator="soapcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${Msisdn}" language_id="${LanguageId}">
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate>
      <set item='oparam:dbresult' value='${dbresult}' />
      <set item='oparam:DateTo' value='${dateto}' />
      <set item='oparam:DateFrom' value='${datefrom}' />
      <set item='oparam:ServiceCode' value='${additionalagreementcode}' />
      <set item='oparam:DaysLeft' value='${daysbeforetheend}' />
    </deliveryTemplate>
    <input>
      <param name="Msisdn" />
      <param name="LanguageId" />
    </input>
    <output>
      <param name="dbresult"  />
      <param name="DateTo"  />
      <param name="DateFrom"  />
      <param name="ServiceCode"  />
      <param name="DaysLeft"  />
    </output>
  </template>

 <template procedureName="DB_PaymentsInformationSync" persistent="false">
    <receiveTemplate>
      <Message type="retrievecustomerdata" initiator="smscon" id="${guid}" session_id="@{setSessionId(@{newGuid})}">
        <Item customer="${Msisdn}" subject="payments">
          <Attribute name="index" value="0" />
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate>
      <set item='oparam:dbresult' value='${dbresult}' />
      <set item='oparam:DateTo' value='${dateto}' />
      <set item='oparam:DateFrom' value='${datefrom}' />
      <set item='oparam:ServiceCode' value='${additionalagreementcode}' />
      <set item='oparam:DaysLeft' value='${daysbeforetheend}' />
    </deliveryTemplate>
    <input>
      <param name="Msisdn" />
      <param name="LanguageId" />
      <param name="PaymentsCount" />
    </input>
    <output>
      <param name="dbresult"  />
      <param name="DateTo"  />
      <param name="DateFrom"  />
      <param name="ServiceCode"  />
      <param name="DaysLeft"  />
    </output>
  </template>


  <template procedureName="DB_BillsInformationSync" persistent="false">
    <receiveTemplate>
      <Message type="retrievecustomerdata" initiator="smscon" id="${guid}" session_id="@{setSessionId(@{newGuid})}">
        <Item customer="${Msisdn}" subject="bills">
          <Attribute name="index" value="0" />
        </Item>
      </Message>
      <deliveryTemplate>
        <set item='oparam:dbresult' value='${dbresult}' />
        <set item='oparam:IvrAccountInfoInactive' value='${dateto}' />
        <set item='oparam:Bills' value='${datefrom}' />
      </deliveryTemplate>
      <input>
        <param name="Msisdn" />
        <param name="LanguageId" />
        <param name="BillsCount" />
      </input>
      <output>
        <param name="dbresult"  />
        <param name="IvrAccountInfoInactive"  />
        <param name="Bills"  />
      </output>
    </receiveTemplate>
  </template>




	<!--template procedureName="DB_AddRemoveService"  persistent="true">
    <receiveTemplate>
      <Message type="bundleprovision" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${servicecode}" action="#{if('${serviceaction}'='2','add',if('${serviceaction}'='3','remove',-1))}" needtariffication="1" enddate="${enddate}" informOnImpossibility="${informOnImpossibility}" sourcetypeid ="${sourcetypeid}" userid="${userid}" />
        </Item>
      </Message>
    </receiveTemplate>
	  <deliveryTemplate conditionEx="#{'${dbresult}'='320191' and //Service/@id='ULTRA'}" call="ULTRA">
	    <set item="iparam:customer" value="${customer}" />
		 <set conditionEx="0@{freeSession}" />
	</deliveryTemplate>
    <deliveryTemplate conditionEx="#{'${message}'=''}">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate conditionEx="#{'${message}'!=''}" terminating="false">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
   <deliveryTemplate connector="_SMSCON">
      <set item="Content" value="${message}" />
      <set item="Recipient" value="${customer}" />
    </deliveryTemplate>

    <input>
      <param name="customer" />
      <param name="servicecode" value="" />
      <param name="serviceaction" value="-1" />
      <param name="needtariffication" value="-1" />
	  <param name="enddate" value="00.00.01 01.01.2099"/>
      <param name="informOnImpossibility" value="-1" />
      <param name="sourcetypeid" value="1" />
      <param name="userid" value="1" />
    </input>
    <output>
      <param name="RESULT" value="-1" />
    </output>
  </template> 
	
  <template procedureName="ULTRA">
    <receiveTemplate>
      <Message type="closeultra" initiator="soapcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate conditionEx="#'${calcmethod}'='0'" call="Send">
	  <set item="iparam:customer" value="${customer}" />
	   <set conditionEx="0@{freeSession}" />
  <set item="param:dbresult" value="" />
    </deliveryTemplate>
	 <deliveryTemplate >
      <set item="oparam:RESULT" value="320191" />
	  </deliveryTemplate>
	<input>
      <param name="customer" />
    </input>
    <output>
      <param name="RESULT" value="320191" />
    </output>
  </template>

  <template procedureName="Send" persistent="false">
    <receiveTemplate>
      <Message type="deliveryrequest" initiator="smscon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" sender="MTC">
          <Content encoding="7bit" charset="iso-8859-2">Na zhal na Vashomu rahunku ned–æstatnjo koshtiv dlja aktyvatsii poslugi ULTRA</Content>
        </Item>
      </Message>
    </receiveTemplate>  
     <deliveryTemplate direction="input" terminating="false">
		  <set item="param:dbresult" value="0" />
     </deliveryTemplate> 
     <deliveryTemplate direction="input" connector="SMSCON_01">
     </deliveryTemplate> 
	 	<input>
      <param name="customer" />
    </input>
    <output>
      <param name="RESULT" value="320191" />
    </output>
   </template--> 

	<!--template procedureName="DB_AddRemoveService"  persistent="true">
    <receiveTemplate>
      <Message type="bundleprovision" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${servicecode}" action="#{if('${serviceaction}'='2','add',if('${serviceaction}'='3','remove',-1))}" needtariffication="1" enddate="${enddate}" informOnImpossibility="${informOnImpossibility}" sourcetypeid ="${sourcetypeid}" userid="${userid}" />
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate conditionEx="#{'${message}'=''}">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate conditionEx="#{'${message}'!=''}" terminating="false">
      <set item="oparam:RESULT" value="${dbresult}" />
    </deliveryTemplate>
    <deliveryTemplate connector="_SMSCON">
      <set item="Content" value="${message}" />
      <set item="Recipient" value="${customer}" />
    </deliveryTemplate>
    <input>
      <param name="customer" />
      <param name="servicecode" value="" />
      <param name="serviceaction" value="-1" />
      <param name="needtariffication" value="-1" />
	  <param name="enddate" value="00.00.01 01.01.2099"/>
      <param name="informOnImpossibility" value="-1" />
      <param name="sourcetypeid" value="1" />
      <param name="userid" value="1" />
    </input>
    <output>
      <param name="RESULT" value="-1" />
    </output>
   </template--> 
 
	<template procedureName="DB_AddRemoveService"  persistent="true">
		<receiveTemplate>
			<Message type="bundleprovision" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
					<Service id="${servicecode}" action="#{if('${serviceaction}'='2','add',if('${serviceaction}'='3','remove',-1))}" needtariffication="1" enddate="${enddate}" informOnImpossibility="${informOnImpossibility}" sourcetypeid ="${sourcetypeid}" userid="${userid}" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='320191' and //Service/@id='ULTRA'}" call="ULTRA">
			<set item="iparam:customer" value="${customer}" />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and //Service/@id='ULTRA'}" call="Send1">
			<set item="iparam:customer" value="${customer}" />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${message}'=''}">
			<set item="oparam:RESULT" value="${dbresult}" />
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${message}'!=''}" terminating="false">
			<set item="oparam:RESULT" value="${dbresult}" />
		</deliveryTemplate>
		<deliveryTemplate connector="_SMSCON">
			<set item="Content" value="${message}" />
			<set item="Recipient" value="${customer}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
			<param name="servicecode" value="" />
			<param name="serviceaction" value="-1" />
			<param name="needtariffication" value="-1" />
			<param name="enddate" value="00.00.01 01.01.2099"/>
			<param name="informOnImpossibility" value="-1" />
			<param name="sourcetypeid" value="1" />
			<param name="userid" value="1" />
		</input>
		<output>
			<param name="RESULT" value="-1" />
		</output>
	</template> 

	<template procedureName="ULTRA">
		<receiveTemplate>
			<Message type="closeultra" initiator="soapcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate conditionEx="#'${calcmethod}'='0'" call="Send">
			<set item="iparam:customer" value="${customer}" />
			<set conditionEx="0@{freeSession}" />
			<set item="param:dbresult" value="" />
		</deliveryTemplate>
		<deliveryTemplate >
			<set item="oparam:RESULT" value="320191" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="RESULT" value="320191" />
		</output>
	</template>

	<template procedureName="Send" persistent="false">
		<receiveTemplate>
			<Message type="deliveryrequest" initiator="smscon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}" sender="MTC">
					<Content encoding="7bit" charset="iso-8859-2">Poslugu &quot;ULTRA&quot; ne mozhe buty pidklyucheno. Bud' laska, popovnit' Vash rahunok. Vartist' pidklyuchennia - 317,69grn z PDV ta PF.</Content>
				</Item>
			</Message>
		</receiveTemplate>  
		<deliveryTemplate direction="input" terminating="false">
			<set item="param:dbresult" value="0" />
		</deliveryTemplate> 
		<deliveryTemplate direction="input" connector="SMSCON_01">
		</deliveryTemplate> 
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="RESULT" value="320191" />
		</output>
	</template>    

	<template procedureName="Send1" persistent="false">
		<receiveTemplate>
			<Message type="deliveryrequest" initiator="smscon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}" sender="MTC">
					<Content encoding="7bit" charset="iso-8859-2">Poslugu &quot;ULTRA&quot; bude pidklyucheno vprodovzh doby za najavnosti na balansi neobhidnoji dlya oplaty sumy (317,69grn z PDV ta PF).</Content>
				</Item>
			</Message>
		</receiveTemplate>  
		<deliveryTemplate direction="input" terminating="false">
			<set item="param:dbresult" value="0" />
		</deliveryTemplate> 
		<deliveryTemplate direction="input" connector="SMSCON_01">
		</deliveryTemplate> 
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="RESULT" value="0" />
		</output>
	</template>

	<!--param name="enddate" value="00.00.01 01.01.2099" /-->
	<template procedureName='TestMethod'>
		<receiveTemplate>
			<Message type='verificationrequest' initiator='soapcon' id='${guid}' session_id='@{newGuid}'>
				<Item customer='${customer}'>
					<Attribute name='checkivrservice' value='0' />
					<Attribute name='checkblocks' value='0' />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item='oparam:dbresult' value='${dbresult}' />
			<set item='oparam:tariffplan' value='${tariffplan}' />
		</deliveryTemplate>
		<input>
			<param name='customer' />
		</input>
		<output>
			<param name='dbresult' />
			<param name='tariffplan' />
		</output>
	</template>

	<template procedureName="DB_AddRemoveRBTService" sessionLifetime="60" onClean="Session_onClean">
		<receiveTemplate>
			<Message type="serviceinterrogation" initiator="ivrcon" id="@{setMessageId(@{newGuid})}" session_id="@{setSessionId(${MSISDN})}">
				<Item customer="${MSISDN}">
					<Service id="FRPOPMAP" action="interrogation" /> 
				</Item>
				@{store(storeMSISDN,${MSISDN})}
				@{store(storeaction,${action})}
			</Message>
		</receiveTemplate>
		<deliveryTemplate conditionEx="#{${dbresult}=0 and ${subscription}=0}" call="DB_AddRemoveRBTServiceFRGOOD">
			<set item="iparam:MSISDN" value="${storeMSISDN}"/>
			<set item="iparam:action" value="${storeaction}"/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{${dbresult}=0 and ${subscription}=1}" call="DB_AddRemoveRBTServicePOPGODOK">
			<set item="iparam:MSISDN" value="${storeMSISDN}"/>
			<set item="iparam:action" value="${storeaction}"/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate>
			<set item='oparam:RESULT'  value='${dbresult}' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=0}"   value='OK' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320191}" value='BALANCE_NOT_ENOUGHT' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320204}" value='WRONG_TARIFF' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320206}" value='SERVICE_ALREADY_DELETED' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320205}" value='SERVICE_ALREADY_ADDED' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320203}" value='ANOTHER_REQUEST_IN_PROGRESS' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320341}" value='SUBSCRIBER_NOT_FOUND' />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<input>
			<param name='MSISDN' />
			<param name='action' />
		</input>
		<output>
			<param name='RESULT' />
		</output>
	</template>

	<template procedureName="DB_AddRemoveRBTServiceFRGOOD" sessionLifetime="60" onClean="Session_onClean">
		<receiveTemplate>
			<Message type='serviceorder' initiator='ivrcon' id="@{setMessageId(@{newGuid})}" session_id="@{setSessionId(@{newGuid})}">
				<Item customer='${MSISDN}'>
					<Service id="FRGOOD" action="#{if('${action}'='add',2,if('${action}'='remove',3,-1))}" class="1" />
				</Item>@{store(SOAPRequest,@{GetSOAPRequest()})}</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item='oparam:RESULT'  value='${dbresult}' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=0}"   value='OK' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320191}" value='BALANCE_NOT_ENOUGHT' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320204}" value='WRONG_TARIFF' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320206}" value='SERVICE_ALREADY_DELETED' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320205}" value='SERVICE_ALREADY_ADDED' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320203}" value='ANOTHER_REQUEST_IN_PROGRESS' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320341}" value='SUBSCRIBER_NOT_FOUND' />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<input>
			<param name='MSISDN' />
			<param name='action' />
		</input>
		<output>
			<param name='RESULT' />
		</output>
	</template>

	<template procedureName="DB_AddRemoveRBTServicePOPGODOK" sessionLifetime="60" onClean="Session_onClean">
		<receiveTemplate>
			<Message type='serviceorder' initiator='ivrcon' id="@{setMessageId(@{newGuid})}" session_id="@{setSessionId(@{newGuid})}">
				<Item customer='${MSISDN}'>
					<Service id="POPGODOK" action="#{if('${action}'='add',2,if('${action}'='remove',3,-1))}" class="1" />
				</Item>@{store(SOAPRequest,@{GetSOAPRequest()})}</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item='oparam:RESULT'  value='${dbresult}' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=0}"   value='OK' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320191}" value='BALANCE_NOT_ENOUGHT' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320204}" value='WRONG_TARIFF' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320206}" value='SERVICE_ALREADY_DELETED' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320205}" value='SERVICE_ALREADY_ADDED' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320203}" value='ANOTHER_REQUEST_IN_PROGRESS' />
			<set item='oparam:RESULT'  conditionEx="#{${dbresult}=320341}" value='SUBSCRIBER_NOT_FOUND' />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<input>
			<param name='MSISDN' />
			<param name='action' />
		</input>
		<output>
			<param name='RESULT' />
		</output>
	</template>

	<!--template procedureName="DB_AddRemoveRBTService" sessionLifetime="60" onClean="Session_onClean">
    <receiveTemplate>
      <Message type='serviceorder' initiator='ivrcon' id="@{setMessageId(@{newGuid})}" session_id="@{setSessionId(@{newGuid})}">
        <Item customer='${MSISDN}'>
          <Service id="FRGOOD" action="#{if('${action}'='add',2,if('${action}'='remove',3,-1))}" class="1" />
        </Item>@{store(SOAPRequest,@{GetSOAPRequest()})}</Message>
    </receiveTemplate>
    <deliveryTemplate>
      <set item='oparam:RESULT' 	value='${dbresult}' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=0}" 		value='OK' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320191}" value='BALANCE_NOT_ENOUGHT' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320204}" value='WRONG_TARIFF' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320206}" value='SERVICE_ALREADY_DELETED' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320205}" value='SERVICE_ALREADY_ADDED' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320203}" value='ANOTHER_REQUEST_IN_PROGRESS' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320341}" value='SUBSCRIBER_NOT_FOUND' />
      <set conditionEx="0@{freeSession}" />
    </deliveryTemplate>
    <input>
      <param name='MSISDN' />
      <param name='action' />
    </input>
    <output>
      <param name='RESULT' />
    </output>
    </template-->
	<!--template procedureName="DB_AddRemoveRBTService" sessionLifetime="60" onClean="Session_onClean">
    <receiveTemplate>
      <Message type='serviceorder' initiator='ivrcon' id="@{setMessageId(@{newGuid})}" session_id="@{setSessionId(@{newGuid})}">
        <Item customer='${MSISDN}'>
          <Service id="FRGOOD" action="#{if('${action}'='add',2,if('${action}'='remove',3,-1))}" class="1" />
        </Item>@{store(SOAPRequest,@{GetSOAPRequest()})}</Message>
    </receiveTemplate>
    <deliveryTemplate>
      <set item='oparam:RESULT' 	value='UNKNOWN ERROR' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=0}" 		value='OK' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320191}" value='BALANCE_NOT_ENOUGHT' />
      <set item='oparam:RESULT' 	conditionEx="#{${dbresult}=320204}" value='WRONG_TARIFF' />
      <set conditionEx="0@{freeSession}" />
    </deliveryTemplate>
    <input>
      <param name='MSISDN' />
      <param name='action' />
    </input>
    <output>
      <param name='RESULT' />
    </output>
  </template-->

	<template procedureName="DB_ServiceActivation" persistent="false">
		<condition>
		</condition>
		<receiveTemplate>
			<Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
					<Service id="${service}" action="2" class="1" createrequest="1"/>
				</Item>
			</Message>
		</receiveTemplate>
		<input>
			<param name="customer" />
			<param name="service" />
		</input>
		<output>
			<param name="dbresult" type="3" value="" /> 
		</output>
	</template>

	<template procedureName="DB_ServiceDeactivation" persistent="false">
		<condition>
		</condition>
		<receiveTemplate>
			<Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
					<Service id="${service}" action="3" class="1" createrequest="1"/>
				</Item>
			</Message>
		</receiveTemplate>
		<input>
			<param name="customer" />
			<param name="service" />
		</input>
		<output>
			<param name="dbresult" type="3" value="" /> 
		</output>
	</template>  

	<template procedureName="GetInvocationsList" sessionStorage="Database" sessionLifetime="30">
		<input>
			<param name="customer" />
		</input>
		<receiveTemplate>
			<Message type="getinvocationlist" initiator="soapcon" id="${guid}" session_id="@{setSessionId(@{newGuid})}">
				<Item customer="${customer}" />@{store(sInviter,${customer})}            @{store(sInvited,79151536837)}            @{store(sRegion,1)}</Message>
		</receiveTemplate>
		<deliveryTemplate direction="input">
			<set item="oparam:dbresult" value="0" />
			<set item="oparam:invocationslist" value="@{GetCountSessionsContaining(sInviter,79163515044)}" />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<output>
			<param name="dbresult" value="" />
			<param name="invocationslist" value="" />
		</output>
	</template> 

	<template procedureName="DB_PrP2PoPMigrationPossibility">
		<receiveTemplate>
			<Message type="prp2popmigrationpossibility" initiator="jrm" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}" />
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<!--set item="oparam:ICCID" conditionEx!="#{${dbresult}=0}" value="" /-->
			<set item="oparam:ResultCode" value="UnknownError" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=0}" value="OK" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=320341}" value="InvalidNumber" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=320347}" value="PhoneBlocked" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=320191}" value="NotEnoughMoney" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=321003}" value="MigratedFromPoP" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=321004}" value="AlreadyMigrated" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=321005}" value="ProhibitedTariff" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="ResultCode" value=""/>
			<param name="ICCID" value=""  />
			<param name="IMSI" value=""  />
			<param name="firstcall" value="" />
			<param name="pin1" value="" />
			<param name="puk2" value="" />
			<param name="ki" value="" />
			<param name="puk1" value="" />
			<param name="pin2" value="" />    
		</output>
	</template>  

	<template procedureName="DB_PrP2PoPMigrationProcess" sessionStorage="Memory" sessionLifetime="60" persistent="true">
		<receiveTemplate>
			<Message type="prp2popmigrationprocess" initiator="jrm" id="${guid}" session_id="@{setSessionId(@{newGuid})}">
				<Item customer="${Customer}" imsi="${IMSI}" startmigration="${StartMigration}"/>
				@{store(sStartMigration,${StartMigration})}
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:ResultCode" value="UnknownError" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=0}" value="OK" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=321002}" value="InvalidStatus" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=320341}" value="InvalidNumber" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=321001}" value="MSISDN_IMSI_mismatch" />
			<set item="oparam:RequestId" conditionEx="#{'${sStartMigration}'='0' or ${dbresult}!=0}" value="" />
			<set conditionEx="0@{freeSession}" />
		</deliveryTemplate>
		<input>
			<param name="Customer" />
			<param name="IMSI" />
			<param name="StartMigration" />
		</input>
		<output>
			<param name="Status" value=""  />
			<param name="ResultCode" value=""/>
			<param name="RequestId" value=""  />
		</output>
	</template>

	<template procedureName="DB_PrP2PoPGetServiceStatus">
		<receiveTemplate>
			<Message type="prp2popgetservicestatus" initiator="jrm" id="${guid}" session_id="@{newGuid}">
				<Item customer="${Customer}" serviceid="${ServiceID}"/>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:ResultCode" value="UnknownError" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=0}" value="OK" />
			<set item="oparam:ResultCode" conditionEx="#{${dbresult}=320341}" value="InvalidNumber" />
			<set item="oparam:ServiceStatus" conditionEx="#{${dbresult}!=0}" value="" />
		</deliveryTemplate>
		<input>
			<param name="Customer" />
			<param name="ServiceID" />
		</input>
		<output>
			<param name="ResultCode" value=""/>
			<param name="ServiceStatus" value="" />
		</output>
	</template>

	<template procedureName="SendPriceSMS" persistent="false">
		<receiveTemplate>
			<Message type="deliveryrequest" initiator="smscon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${recipient}" sender="111">
					<Content encoding="7bit" charset="iso-8859-2">${content}</Content>
				</Item>
			</Message>
		</receiveTemplate>  
		<deliveryTemplate direction="input" terminating="false">
			<set item="param:dbresult" value="0" />
		</deliveryTemplate> 
		<deliveryTemplate direction="input" connector="SMSCON_01">
		</deliveryTemplate> 
		<input>
			<param name="recipient" />    
			<param name="content" />
		</input>   
		<output>
			<param name="dbresult" type="3" value="0"/>	
		</output>
	</template>  
	<!--Attribute name="in_act_date" type="DATETIME" value="#{substring(${ActivationDate},1,4)}.#{substring(${ActivationDate},5,2)}.#{substring(${ActivationDate},7,3)}" /-->

	<!--Attribute name="in_act_date" type="DATETIME" value="${ActivationDate}" /-->
	<template procedureName="DB_PoP2PrPMigrationStart" handler="DBCON_03">
		<receiveTemplate>
			<Message initiator="jrm" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="down_cust_big.migrate_pop2prp">
					<Attribute name="in_msisdn" type="STRING" value="${Customer}" />
					<Attribute name="in_imsi" type="STRING" value="${IMSI}" />
					<Attribute name="in_iccid" type="STRING" value="${ICCID}" />
					<Attribute name="in_pin1" type="STRING" value="${PIN1}" />
					<Attribute name="in_pin2" type="STRING" value="${PIN2}" />
					<Attribute name="in_puk1" type="STRING" value="${PUK1}" />
					<Attribute name="in_puk2" type="STRING" value="${PUK2}" />
					<Attribute name="in_ki" type="STRING" value="${A4Ki}" />
					<Attribute name="in_act_date" type="STRING" value="${ActivationDate}" />
					<Attribute name="in_balance" type="INT" value="${Balance}" />
					<Attribute name="in_expire_in_days" type="INT" value="${ExpireInDays}" />
					<Attribute name="in_tp_id" type="INT" value="${TariffPlanId}" />
					<Attribute name="out_req_id" type="STRING" />
					<Attribute name="out_rc" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:ResultCode" value="${out_rc}" />
			<set item="oparam:RequestId" value="${out_req_id}" />
		</deliveryTemplate>
		<input>
			<param name="Customer" />
			<param name="IMSI" />
			<param name="ICCID" />
			<param name="PIN1" />
			<param name="PIN2" />
			<param name="PUK1" />
			<param name="PUK2" />
			<param name="A4Ki" />
			<param name="ActivationDate" />
			<param name="Balance" />
			<param name="ExpireInDays" />
			<param name="TariffPlanId" />
		</input>
		<output>
			<param name="ResultCode" value=""/>
			<param name="RequestId" value=""  />
		</output>
	</template>

	<template procedureName="BMS_StartingDate" persistent="false">
		<receiveTemplate>
			<Message type="getstartingdataformsisdnrequest" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}">
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="${dbresult}" />
			<set item="oparam:startingdate" value="${startingdate}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"        type="3"  value="-1" />
			<param name="startingdate"    type="1"  value="" />
		</output>
	</template>

	<template procedureName="Session_onClean" sessionStorage="Memory">
		<deliveryTemplate>
			<set conditionEx="0@{BuildSOAPResponse(${SOAPRequest})}" />
			<set item='oparam:RESULT' 	value='UNKNOWN ERROR' />
		</deliveryTemplate>
		<output>
			<param name='RESULT' />
		</output>
	</template>







	<template procedureName="Check_SMARTSMS">	
		<receiveTemplate>
			<Message type="serviceinterrogation" initiator="ussd" id="@{newGuid}" session_id="@{setSessionId(${customer}ACTPOPSMARTSMS)}">
				<Item customer="${customer}">
					<Service id="POPSMARTSMS" action="interrogation"/>
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='1' and '${language_id}'='1'}">
			<set item="oparam:result" value="Service Smart SMS is already activated." />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='1' and '${language_id}'='3'}">
			<set item="oparam:result" value="Usluga Smart SMS aktivna." />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='1'}">
			<set item="oparam:result" value="Posluga Smart SMS aktyvna." />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='0' and '${language_id}'='1'}" >
			<set item="oparam:result" value="Service is unavailable. To activate dial *110*881#" />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='0' and '${language_id}'='3'}" >
			<set item="oparam:result" value="Usluga ne aktivna. Dlya podklyucheniya naberite *110*881#" />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='0'}" >
			<set item="oparam:result" value="Poslug‡ ne aktyvn‡. Dlya pidklyuchennya naberit' *110*881#" />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate>
			<set item="oparam:result" value="Oshibka podklyucheniya uslugi. Poprobuite pozdnee."/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<input>
			<param name="customer"/>
		</input>
		<output>
			<param name="result"/>
		</output>
	</template>
	<!--template procedureName="Activate_SMARTSMS" sessionStorage="Database" sessionLifetime="180">	
		<receiveTemplate>
			<Message type="serviceinterrogation" initiator="ussd" id="@{newGuid}" session_id="@{setSessionId(${customer}ACTPOPSMARTSMS)}">
				<Item customer="${customer}">
					<Service id="POPTBSMS" action="interrogation"/>
				</Item>
				@{store(sAction,${action})}
			</Message>
		</receiveTemplate>		
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='1'}" call="Activate_SMARTSMS_2">
			<set item="iparam:customer" value="${customer}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='0' and '${language_id}'='1'}" >
			<set item="oparam:result" value="Your number can not take part in Campaign" />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='0' and '${language_id}'='3'}" >
			<set item="oparam:result" value="Vash nomer ne uchavstvuet v Akcii" />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'='0' and '${subscription}'='0'}" >
			<set item="oparam:result" value="Vash nomer ne bere uchasti v Aktsii" />
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate>
			<set item="oparam:result" value="Oshibka podklyucheniya uslugi. Poprobuite pozdnee."/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<input>
			<param name="customer"/>
			<param name="action"/>
		</input>
		<output>
			<param name="customer"/>
			<param name="result"/>
		</output>
	</template-->
	<template procedureName="Activate_SMARTSMS" sessionStorage="Database" sessionLifetime="180">	
		<receiveTemplate>
			<Message type="serviceorder" initiator="ussd" id="@{newGuid}" session_id="@{setSessionId(${customer}ACTPOPSMARTSMS)}">
				<Item customer="${customer}">
					<Service id="POPSMARTSMS" action="${action}"/>
				</Item>
				@{store(sAction,${action})}
			</Message>
		</receiveTemplate>
		<deliveryTemplate conditionEx="#{'${dbresult}'!='0' and '${dbresult}'!='320205' and '${dbresult}'!='320206'}">
			<set item="oparam:result" value="Oshibka podklyucheniya uslugi. Poprobuite pozdnee."/>
			<set item="oparam:result" condition="//Item/@dbresult=320203" value="Operaciya ne mozhet byt vypolnenna, poka nezavershitsya predydushaya."/>
			<set item="oparam:result" condition="//Item/@dbresult=320191" value="Nedostatochno sredstv dlya vypolneniya dannoi operacii. Popolnite svoi balans i povtorite operaciyu."/>
			<set item="oparam:result" condition="//Item/@dbresult=320204" value="Usluga &quot;Smart SMS&quot; ne predostavlyaetsya dlya Vashego tarifnogo plana."/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${language_id}'='1'}" >
			<set item="oparam:result" condition="//Item/@dbresult=0" value="#{if(${sAction}='2','Your activation request is received. The request will be processed within 24 hours of which you will be additionally informed by SMS','Service Smart SMS is deactivated')}" />
			<set item="oparam:result" condition="//Item/@dbresult=320205" value="Service Smart SMS is already activated"/>
			<set item="oparam:result" condition="//Item/@dbresult=320206" value="Service is unavailable. To activate dial *110*881#"/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate conditionEx="#{'${language_id}'='3'}" >
			<set item="oparam:result" condition="//Item/@dbresult=0" value="#{if(${sAction}='2','Vash zakaz na podklyuchenie uslugi prinyat. Zapros budet obrabotan v techenie sutok, o chem dopolnitel&apos;no Vy budete uvedomleny po SMS','Usluga Smart SMS neaktivna')}" />
			<set item="oparam:result" condition="//Item/@dbresult=320205" value="Usluga Smart SMS aktivna"/>
			<set item="oparam:result" condition="//Item/@dbresult=320206" value="Usluga ne aktivirovana. Dlya podklyucheniya naberite *110*881#"/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<deliveryTemplate>
			<set item="oparam:result" condition="//Item/@dbresult=0" value="#{if(${sAction}='2','Vashe zamovlennya na pidklyuchennya poslugy pryjnyato. Zapyt bude obrobleno protyagom doby, pro shcho Vam bude dodatkovo povidomleno za dopomogoyu SMS','Poslugu Smart SMS deaktyvovano')}" />
			<set item="oparam:result" condition="//Item/@dbresult=320205" value="Posluga Smart SMS aktyvna"/>
			<set item="oparam:result" condition="//Item/@dbresult=320206" value="Poslugu ne aktyvovano. Dlya pidklyuchennya naberit' *110*881#"/>
			<set conditionEx="0@{freeSession}"/>
		</deliveryTemplate>
		<input>
			<param name="customer"/>
			<param name="action"/>
		</input>
		<output>
			<param name="result"/>
		</output>
	</template>

	<template procedureName="DB_CustomerCategoryRetriev" persistent="false">
		<receiveTemplate>
			<Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${customer}" subject="category" />
			</Message>
		</receiveTemplate>
		<input>
			<param name="customer" />      
		</input>
		<output>
			<param name="customercategory" type="2" value="0" />
			<param name="clientstatus" type="3" value="0" />
			<param name="personalaccounttype" type="3" value="0" />
		</output>
	</template>



	<template procedureName="DB_ACCOUNT_ENDDATE" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE2" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_2">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE3" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_3">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE4" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_4">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE5" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_5">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE6" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_6">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE7" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_7">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE8" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_8">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE9" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_9">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE10" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_10">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE11" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_11">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE12" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_12">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE13" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_13">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE14" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_14">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE15" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_15">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE16" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_16">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE17" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_17">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE18" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_18">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE19" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_19">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE21" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_21">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE22" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_22">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE23" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_23">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE24" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_24">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE25" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_25">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE26" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_26">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE27" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_27">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE30" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_30">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE31" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_31">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE32" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_32">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE33" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_33">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE34" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_34">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="DB_ACCOUNT_ENDDATE35" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.UMC_GET_ENDDATE_35">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>


	<template procedureName="GET_INFO_VM" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.GET_INFO_VM">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_date_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:date_result" value="${p_date_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="-1" />
			<param name="date_result"   type="1" value="-1" />
		</output>	
	</template>

	<template procedureName="GET_INFO_TP" handler="DBCON_21" persistent="false">
		<receiveTemplate>
			<Message initiator="ussd" id="${guid}" session_id="@{newGuid}">
				<Item procedureName="MG.GET_INFO_TP">
					<Attribute name="p_msisdn" type="STRING" value="${customer}" />
					<Attribute name="p_dbresult" type="STRING" />
					<Attribute name="p_result" type="STRING" />
				</Item>
			</Message>
		</receiveTemplate>
		<deliveryTemplate>
			<set item="oparam:dbresult" value="#{if('${p_dbresult}'='',-1,number('${p_dbresult}'))}" />
			<set item="oparam:tariffplan" value="${p_result}" />
		</deliveryTemplate>
		<input>
			<param name="customer" />
		</input>
		<output>
			<param name="dbresult"  type="3" value="" />
			<param name="tariffplan"   type="1" value="" />
		</output>	
	</template>

<!-- FORIS.MessagingGateway.Templates 10.10.18 --> 
<template procedureName="GetCBCountersAcync">
  <receiveTemplate>
	  <Message type="retrievecustomerdata" initiator="smscon" id="${guid}" session_id="UNIBALANCE">
		  <Item customer="${customer}" subject="balance">
			  <Attribute name="requestcountertype" value="3"/>
		  </Item>
	  </Message>
	</receiveTemplate>
	<deliveryTemplate direction="input" terminating="false">
		<set item="oparam:dbresult" value="0" /> 
	</deliveryTemplate>
	<deliveryTemplate connector="_SMSCON" /> 
	<input>
		<param name="customer" /> 
	</input>
	<output>
		<param name="dbresult" /> 
	</output>
</template>
<!-- FORIS.MessagingGateway.Templates 10.10.18 --> 

	<template procedureName="SendPriceSMS_1" persistent="false">
		<condition>
		</condition>
		<receiveTemplate>
			<Message type="deliveryrequest" initiator="smscon" id="${guid}" session_id="@{newGuid}">
				<Item customer="${recipient}">
					<Content encoding="7bit" charset="unicodefffe">${content}</Content>
				</Item>
			</Message>
		</receiveTemplate>  
		<deliveryTemplate direction="input" terminating="false">
			<set item="param:dbresult" value="0" />
		</deliveryTemplate> 
		<deliveryTemplate connector="SMSCON_02" />
		<input>
			<param name="recipient" />    
			<param name="content" />
		</input>   
		<output>
			<param name="dbresult" type="3" value="0"/>	
		</output>
	</template> 

</templates>