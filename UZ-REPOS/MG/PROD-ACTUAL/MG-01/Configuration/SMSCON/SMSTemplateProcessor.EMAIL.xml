<templates connector="SMS">
	#include "Configuration\SMSCON\Config\SMS\MTSGROUP.xml" 
	#include "Configuration\SMSCON\Config\GPRS\sms.xml" 
	<macros>
		<!-- ==========================  REDIRECT CONNECTORS   ========================= -->
		<define name="_SMSCON_ISSA"                     value="SMSCON_01_02"/>
		<define name="_USSD_1"                          value="USSDCON_01_01"/>
		<!-- ==========================  REDIRECT CONNECTORS   ========================= -->

		<!-- ==========================  SMSCON SPECIAL   ========================= -->
		<define name="_SMS_NUM_1"                       value="111"/>
		<define name="_SMS_NUM_2"                       value="1771"/>
		<!-- ==========================  SMSCON SPECIAL   ========================= -->
		
		<!-- ==========================  SERVICE PROVISIONING  ========================= -->
		<define name="_GET_SERVICE_RESULT"              value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@info_${sDbresult}__GET_LANG}'='','#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/@info_${sDbresult}__GET_LANG}'='','_GET_DBRESULT','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/@info_${sDbresult}__GET_LANG}')}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@info_${sDbresult}__GET_LANG}')}"/>
		<define name="_GET_CONFIRM_SERVICE_RESULT"      value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='_SERVICE_CODE']/@info_${sDbresult}__GET_LANG}'='','#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='#{document('Config\Service\SERVICE.xml')/ServiceList/GroupList/Item[@id='#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='_SERVICE_CODE']/@group}']/@name}']/@info_${sDbresult}__GET_LANG}'='','_GET_DBRESULT','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='#{document('Config\Service\SERVICE.xml')/ServiceList/GroupList/Item[@id='#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='_SERVICE_CODE']/@group}']/@name}']/@info_${sDbresult}__GET_LANG}')}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='_SERVICE_CODE']/@info_${sDbresult}__GET_LANG}')}"/>
		<define name="_SERVICE_CONFIRM_NAME"            value="#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='_SERVICE_CODE']/@service_name__GET_LANG}"/>
		<define name="_SERVICE_TP_CNT"                  value="#{if(count(document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}']/ivrcode)>0,count(document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}']/ivrcode),count(document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}']/ivrcode))}"/>
		<define name="_SERVICE_TP_ISAVAIL"                 value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1]/@available}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1]/@available}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/tplist[1]/@available}')}"/>
		<define name="_SERVICE_TP_NOTAVALINFO"             value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1]/@info_notaval__GET_LANG}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1]/@info_notaval__GET_LANG}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/tplist[1]/@info_notaval__GET_LANG}')}"/>
		<define name="_SERVICE_CUSTLST_CNT"             value="#{if(count(document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/customer[@value='${customer}']/@value)>0,count(document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/customer[@value='${customer}']/@value),count(document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/customerlist[1]/customer[@value='${customer}']/@value))}"/>
		<define name="_SERVICE_CUSTLST_ISAVAIL"            value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/@available}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/@available}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/customerlist[1]/@available}')}"/>
		<define name="_SERVICE_CUSTLST_NOTAVAILINFO"       value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/@info_notaval__GET_LANG}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/@info_notaval__GET_LANG}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/customerlist[1]/@info_notaval__GET_LANG}')}"/>
		<define name="_SERVICE_SRVBIND_CNT"             value="#{if(count(document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service)>0,count(document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service),count(document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/servicebindinglist[1]/service))}"/>
		<define name="_SERVICE_SRVBIND_SRVCODE"            value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@service_code}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@service_code}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@service_code}')}"/>
		<define name="_SERVICE_SRVBIND_SUBSR"              value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@subscription}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@subscription}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@subscription}')}"/>
		<define name="_SERVICE_SRVBIND_STORE"              value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@store}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@store}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@store}')}"/>
		<define name="_SERVICE_SRVBIND_INFO"               value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}'!='','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}')}"/>
		<define name="_SERVICE_SUCCESSFUL_RESPONSE"     value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@successful_response}'='','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/@successful_response}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@successful_response}')}"/>
		<define name="_SERVICE_CHECKBLOCK"              value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@check_block}'='','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/@check_block}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@check_block}')}"/>
		<define name="_SERVICE_REDIRECT"                value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@redirect}'='','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/@redirect}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@redirect}')}"/>
		<define name="_SERVICE_AVAIL_BAL"               value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@availbalance}'='','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='${sGroupName}']/@availbalance}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@availbalance}')}"/>
		<define name="_SERVICE_TIMETOPROGRESS"          value="#{if('#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='#{if('${sServiceCode}'='','_SERVICE_CODE','${sServiceCode}')}']/@timetoprogress}'='','#{document('Config\Service\SERVICE.xml')/ServiceList/Group[@name='#{if('${sGroupName}'='','_SERVICE_GROUPNAME','${sGroupName}')}']/@timetoprogress}','#{document('Config\Service\SERVICE.xml')/ServiceList/Service[@service_code='#{if('${sServiceCode}'='','_SERVICE_CODE','${sServiceCode}')}']/@timetoprogress}')}"/>
		<define name="_SERVICE_DATEFROM"                value="#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@datefrom}"/>
		<define name="_SERVICE_DATETO"                  value="#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@dateto}"/>
		<define name="_SERVICE_NAME"                    value="#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@service_name__GET_LANG}"/>
		<define name="_SERVICE_GROUPNAME"               value="#{document('Config\Service\SERVICE.xml')/ServiceList/GroupList/Item[@id='#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@group}']/@name}"/>
		<define name="_SERVICE_COMM_ACTION"             value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[_CURRENT_MODULE/@value='${sAction}']/@action}"/>
		<define name="_SERVICE_COMM_STATUS"             value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[_CURRENT_MODULE/@value='${sAction}']/@status}"/>
		<define name="_SERVICE_COMM_CODE"               value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[_CURRENT_MODULE/@value='${sAction}']/@code}"/>
		<define name="_SERVICE_COMM_ACTPARCE"           value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[_CURRENT_MODULE/@value='${sAction}']/@parce}"/>
		<define name="_SERVICE_CRMSTATUS"               value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[@status='${subscription}']/@parce}"/>
		<define name="_SERVICE_CRMACTION_ADD"           value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[@action='2']/@parce}"/>
		<define name="_SERVICE_CRMACTION_DEL"           value="#{document('Config\Service\SERVICE.xml')/ServiceList/CommandList/Command[@action='3']/@parce}"/>
		<define name="_SERVICE_CODE"                    value="#{document('Config\Service\SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@service_code}"/>
		<!-- ==========================  SERVICE PROVISIONING  ========================= -->

		<!-- ==========================  CHANGE TP   ========================= -->
		<define name="_GET_TARIFF_RESULT"               value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@info_${sDbresult}__GET_LANG}'='','#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/@info_${sDbresult}__GET_LANG}'='','_GET_DBRESULT','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/@info_${sDbresult}__GET_LANG}')}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@info_${sDbresult}__GET_LANG}')}"/>
		<define name="_GET_CONFIRM_TARIFF_RESULT"       value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@info_${sDbresult}__GET_LANG}'='','#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/GroupList/Item[@id='#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@group}']/@name}']/@info_${sDbresult}__GET_LANG}'='','_GET_DBRESULT','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/GroupList/Item[@id='#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@group}']/@name}']/@info_${sDbresult}__GET_LANG}')}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@info_${sDbresult}__GET_LANG}')}"/>
		<define name="_TARIFF_TP_CNT"                   value="#{if(count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}'])>0,count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}']),count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}']))}"/>
		<define name="_TARIFF_TP_ISAVAIL"                  value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1]/@available}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1]/@available}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1]/@available}')}"/>
		<define name="_TARIFF_TP_NOTAVAILINFO"             value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1]/@info_notaval__GET_LANG}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1]/@info_notaval__GET_LANG}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/tplist[1]/@info_notaval__GET_LANG}')}"/>
		<define name="_TARIFF_CUSTLST_CNT"              value="#{if(count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/customerlist[1]/customer[@value='${customer}'])>0,count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/customerlist[1]/customer[@value='${customer}']),count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/customerlist[1]/customer[@value='${customer}']))}"/>
		<define name="_TARIFF_CUSTLST_ISAVAIL"             value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/customerlist[1]/@available}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/customerlist[1]/@available}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/customerlist[1]/@available}')}"/>
		<define name="_TARIFF_CUSTLST_NOTAVAILINFO"        value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/customerlist[1]/@info_notaval__GET_LANG}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/customerlist[1]/@info_notaval__GET_LANG}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/customerlist[1]/@info_notaval__GET_LANG}')}"/>
		<define name="_TARIFF_SRVBIND_CNT"              value="#{if(count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service)>0,count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service),count(document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/servicebindinglist[1]/service))}"/>
		<define name="_TARIFF_SRVBIND_SRVCODE"             value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@service_code}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@service_code}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@service_code}')}"/>
		<define name="_TARIFF_SRVBIND_SUBSR"               value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@subscription}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@subscription}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@subscription}')}"/>
		<define name="_TARIFF_SRVBIND_STORE"               value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@store}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@store}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@store}')}"/>
		<define name="_TARIFF_SRVBIND_INFO"                value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}'!='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}')}"/>
		<define name="_TARIFF_SUCCESSFUL_RESPONSE"      value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@successful_response}'='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/@successful_response}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@successful_response}')}"/>
		<define name="_TARIFF_CHECKBLOCK"               value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@check_block}'='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/@check_block}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@check_block}')}"/>
		<define name="_TARIFF_REDIRECT"                 value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@redirect}'='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/@redirect}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@redirect}')}"/>
		<define name="_TARIFF_TIMETOPROGRESS"           value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[@ivrcode='#{if('${sTariffIvrCode}'='','_TARIFF_IVRCODE','${sTariffIvrCode}')}']/@timetoprogress}'='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='#{if('${sGroupName}'='','_TARIFF_GROUPNAME','${sGroupName}')}']/@timetoprogress}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[@ivrcode='#{if('${sTariffIvrCode}'='','_TARIFF_IVRCODE','${sTariffIvrCode}')}']/@timetoprogress}')}"/>
		<define name="_TARIFF_AVAIL_BAL"                value="#{if('#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@availbalance}'='','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Group[@name='${sGroupName}']/@availbalance}','#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@availbalance}')}"/>
		<define name="_TARIFF_DATEFROM"                 value="#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@datefrom}"/>
		<define name="_TARIFF_DATETO"                   value="#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@dateto}"/>
		<define name="_TARIFF_NAME"                     value="#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@tariffname__GET_LANG}"/>
		<define name="_TARIFF_GROUPNAME"                value="#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/GroupList/Item[@id='#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@group}']/@name}"/>
		<define name="_TARIFF_CURRENT_NAME"             value="#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[@ivrcode='#{//Message/Item/@tariffplan}']/@tariffname__GET_LANG}"/>
		<define name="_TARIFF_IVRCODE"                  value="#{document('Config\Tariff\TARIFF_PLANS.xml')/TariffPlans/Tariff[_CURRENT_MODULE/@value='${sNewTariffPlan}']/@ivrcode}"/>
		<!-- ==========================  CHANGE TP  ========================= -->

		<!-- ==========================  ALL SERVICE   ========================= -->
		<define name="_COUNTERS_TYPE"                   value="#{document('Config\Service\COUNTERS.xml')/Counters/Group[_CURRENT_MODULE/@value='${sCountertype}']/@name}"/>
		<define name="_GET_ALL_SRV_RESULT"              value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@info_${sDbresult}__GET_LANG}"/>
		<define name="_ALLSERVICE_TP_CNT"               value="count(document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1][ivrcode/@value='#{//Message/Item/@tariffplan}'])"/>
		<define name="_ALLSERVICE_TP_ISAVAIL"               value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1]/@available}"/>
		<define name="_ALLSERVICE_TP_NOTAVAILINFO"          value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/tplist[1]/@info_notaval__GET_LANG}"/>
		<define name="_ALLSERVICE_CUSTLST_CNT"          value="count(document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/customer[@value='${customer}'])"/>
		<define name="_ALLSERVICE_CUSTLST_ISAVAIL"          value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/@available}"/>
		<define name="_ALLSERVICE_CUSTLST_NOTAVAILINFO"     value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/customerlist[1]/@info_notaval__GET_LANG}"/>
		<define name="_ALLSERVICE_SRVBIND_CNT"          value="count(document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service)"/>
		<define name="_ALLSERVICE_SRVBIND_SRVCODE"          value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@service_code}"/>
		<define name="_ALLSERVICE_SRVBIND_SUBSR"            value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@subscription}"/>
		<define name="_ALLSERVICE_SRVBIND_STORE"            value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@store}"/>
		<define name="_ALLSERVICE_SRVBIND_INFO"             value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/servicebindinglist[1]/service[${sCnt}]/@info_notaval__GET_LANG}"/>
		<define name="_ALLSERVICE_SUCCESSFUL_RESPONSE"  value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@successful_response}"/>
		<define name="_ALLSERVICE_CHECKBLOCK"           value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@check_block}"/>
		<define name="_ALLSERVICE_REDIRECT"             value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@redirect}"/>
		<define name="_ALLSERVICE_TIMETOPROGRESS"       value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@timetoprogress}"/>
		<define name="_ALLSERVICE_AVAIL_BAL"            value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@availbalance}"/>
		<define name="_ALLSERVICE_NAME"                 value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Service[_CURRENT_MODULE/@value='${sService}']/@name}"/>
		<!-- ==========================  ALL SERVICE   ========================= -->
		
		<!-- ==========================  SETTINGS   ========================= -->
		<define name="_WAIT_IFASYNC_INPROCESS"          value="#{if('${sDbresult}'='redirect','#{if(not(matches('${sInProgress}','_IF_TRUE')),'true','')}','')}" />
		<define name="_GET_TODAY"                       value="#{concat(substring('@{now}',7,4),substring('@{now}',4,2),substring('@{now}',1,2))}"/>
		<define name="_GET_SECONDS"                     value="#{(number(substring('@{now}',12,2)) * 60 * 60) + (number(substring('@{now}',15,2)) * 60) + number(substring('@{now}',18,2))}"/>
		<define name="_GET_DBRESULT"                    value="#{document('Config\GET_DBRESULT.xml')/DBresults/Item[code/@value='${sDbresult}']/@info__GET_LANG}"/>
		<define name="_GET_LENGTH_DBRESULT"             value="#{string-length(document('Config\GET_DBRESULT.xml')/DBresults/Item[code/@value='${sDbresult}']/@info__GET_LANG)}"/>
		<define name="_GET_AFTER_VERIFY_DBRESULT"       value="#{if('#{document('Config\GET_DBRESULT.xml')/DBresults/Item[code/@value='${customerblocks}']/@info__GET_LANG}'!='','${customerblocks}','${dbresult}')}"/>
		<define name="_ENCODING"                        value="#{document('Config\Service\All_SERVICE.xml')/ServiceList/Language/lang[@param='_GET_LANG']/@encoding}"/>
		<define name="_INLANGUAGE"                      value="#{if('#{document('Config\Service\All_SERVICE.xml')/ServiceList/Language/lang[@scp='${inlang}' and @ussd='${smsussdlang}']/@param}'='','#{document('Config\Service\All_SERVICE.xml')/ServiceList/Language/lang[@scp='' and @ussd='']/@param}','#{document('Config\Service\All_SERVICE.xml')/ServiceList/Language/lang[@scp='${inlang}' and @ussd='${smsussdlang}']/@param}')}" />
		<define name="_GET_LANG"                        value="#{if('${sLang}'='','#{document('Config\Service\All_SERVICE.xml')/ServiceList/Language/lang[@scp='' and @ussd='']/@param}','${sLang}')}" />
		<define name="_DEFAULT_ERR"                     value="#{if('${dbresult}'='-1','err001','${dbresult}')}" />
		<define name="_REDIRECT_TO_SMS"                 value="^[Ss][Mm][Ss]$" />
		<define name="_REDIRECT_TO_CURRENT"             value="^[Nn][Oo][Tt][Rr][Ee][Dd][Ii][Rr][Ee][Cc][Tt]$" />
		<define name="_IF_TRUE"                         value="^([Tt][Rr][Uu][Ee]|1)$" />
		<define name="_BYCRM"                           value="[Bb][Yy][Cc][Rr][Mm]" />
		<define name="_CURRENT_MODULE"                  value="#{if('${sModule}'!='','${sModule}','smscon')}" />
		<define name="_CONFIRM_VALUE"                   value="confirm"/>
		<define name="_CURRENT_INITIATOR"               value="smscon"/>
		<!-- ==========================  SETTINGS   ========================= -->

	</macros>
	<template procedureName="SMS_To_Email" contentSeparator=";" persistent="false" >
		<condition>
			<test item="${Sender}" matches="^\d+(9119831|4344342|4481199)$"/>
			<test item="${Content}" matches="^([\w-\.]+)@((?:[\w]+\.)+)([a-zA-Z]{2,4})\;.+;.+$"/>
		</condition>
		<receiveTemplate>
			<Message process="dispatcher" initiator="_CURRENT_INITIATOR" type="Email_Test" id="@{newGuid}" session_id="@{newGuid}">
				<Package package_id="@{newGuid}" template_id="Email_Test" >
					<Item customer="${token0}">
						<Content type="test" subject="${Sender}:${token1}" text="${token2}"  />
					</Item>
				</Package>
			</Message>
		</receiveTemplate>
	</template>
</templates>