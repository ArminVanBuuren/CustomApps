<Config>
	<!--
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#1 - exception="rollback, skip, stop" настроить roolback, при копировании файлов создавать темповые файлы, как завершится полностью процесс удалять темпоые или роллбэк для восстановления
#2 - настроить считывание и поиск больших файлов для RegexContent и FileRead
#3 - настроить запись в файл - FileWrite и простой поиск FileRead
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-->

	<!-- TestCase 1 -->
	<!--ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<findDirectories DirPath="{localpath}\TESTS\Case-1\Source" >
			<FindFiles matches="^*.xml$" Sub_Directories="true" >
				<GetValueByXPath matches="/BusinessProcessData" >
					<File DirPath="{findDirectories.path}\aaaa" option="move" >
						<Rename matches="^(.+)\.\(.+$" replacement="$1.xml" />
					</File>
				</GetValueByXPath>
			</FindFiles>
		</findDirectories>
	</ScriptTemplate-->
	
	
	<!--Case1 name="{localpath}\TESTS\Case-1\Source\aaaa" />
	<ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<FindFiles DirPath="{Case1.name}" Matches="Add_PART_block_test.xml" >
			<GetValueByXPath matches="/BusinessProcessData" >
				<File DirPath="{Case1.name}\aaaa1" option="replace" >
					<GetValueByXPath matches="//object/@name" Replacement="govno" />
				</File>
			</GetValueByXPath>
		</FindFiles>
	</ScriptTemplate-->

	<!--Case2 name="{localpath}\TESTS\Case-1\Source\aaaa" />
	<ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<FindFiles DirPath="{Case2.name}" Matches="Add_PART_block_test.xml" >
			<File DirPath="{Case2.name}\aaaa1" option="replace" >
				<GetValue Pattern="object" Capture="10;10" Max_Count_Match="5" String_Option="CurrentCultureIgnoreCase" />
			</File>
		</FindFiles>
	</ScriptTemplate-->
	
	<!--Case2 name="{localpath}\TESTS\MG_LOG" />
	<ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<FindFiles DirPath="{Case2.name}" >
			<GetValueByRegex Pattern="^.+serviceorderresult.+70e2e7e7.+$" Options="IgnoreCase|Multiline" >
				<WriteFile File_DirPath="{Case2.name}\Result\result.txt" />
			</GetValueByRegex>
		</FindFiles>
	</ScriptTemplate-->
	
	<!--Case2 name="C:\Users\vkhov\Downloads" replaceA1="AvalonEdit" replaceA2="Script" replaceB1="ICSharpCode" replaceB2="Editor"/>
	<ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<Find DirPath="{Case2.name}\AvalonEdit_4.3.1_Source">
			<Perform DirPath="{Case2.name}\ScriptEdit" Option="Copy" >
				<Find Sub_Directories="true">
					<GetValue Pattern="{Case2.replaceA1}" Replacement="{Case2.replaceA2}" Options="InvariantCultureIgnoreCase" fitback="rollback" />
					<GetValue Pattern="{Case2.replaceB1}" Replacement="{Case2.replaceB2}" Options="InvariantCultureIgnoreCase" fitback="rollback" />
					<Rename Matches="{Case2.replaceA1}" Replacement="{Case2.replaceA2}" />
					<Rename Matches="{Case2.replaceB1}" Replacement="{Case2.replaceB2}" />
				</Find>
			</Perform>
		</Find>
	</ScriptTemplate-->
	
	<!--Case2 name="C:\Users\WADE\Google Диск\PROJECTS\BACKUPS\FindFileByXpath\FindFileByXpath\bin\Debug\TESTS\11" replaceA1="AvalonEdit" replaceA2="Editor" replaceB1="ICSharpCode" replaceB2="Script"/>
	<ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<Find Type="Files" DirPath="{Case2.name}\AvalonEdit_4.3.1_Source" Sub_Directories="true" >
			<Perform Type="Files" DirPath="{Case2.name}\ScriptEdit" Options="Copy" Append_Sub_Directories="true" >
				<Find Type="Files" Sub_Directories="true">
					<GetValue Pattern="{Case2.replaceA1}" Replacement="{Case2.replaceA2}" Options="InvariantCultureIgnoreCase" />
					<GetValue Pattern="{Case2.replaceB1}" Replacement="{Case2.replaceB2}" Options="InvariantCultureIgnoreCase" />
					<Rename Matches="{Case2.replaceA1}" Replacement="{Case2.replaceA2}" >
						<Rename Matches="{Case2.replaceB1}" Replacement="{Case2.replaceB2}" />
					</Rename>
				</Find>
				<Find Type="Dir" Sub_Directories="true">
					<Rename Matches="{Case2.replaceA1}" Replacement="{Case2.replaceA2}" >
						<Rename Matches="{Case2.replaceB1}" Replacement="{Case2.replaceB2}" />
					</Rename>
				</Find>
			</Perform>
		</Find>
	</ScriptTemplate-->
	
	<Case2 from="\\armin\c$\FORIS\ SOURCE\5.4\Projects" to="C:\Users\vkhov\Google Диск\PROJECTS\BACKUPS\FORIS" />
	<ScriptTemplate Name="Script2" Severity="Failure" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<Find Type="Dir" DirPath="{Case2.from}" Matches="^Src$" Sub_Directories="true" >
			<Perform Type="Files" DirPath="{Case2.name}\ScriptEdit" Options="Copy" Append_Sub_Directories="true" >
			</Perform>
		</Find>
	</ScriptTemplate>

	<!--ScriptTemplate Name="Script1" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<FindDirectories DirPath="C:\temp\1" sub_directories="true" matches="^.+$">
			<FindFiles sub_directories="true" matches="^.+.xml$">
				<RegexContent matches="FORIS.ScenarioProcessing.CommonUnits.ConditionalDummyResultCreator" replace="111" option="IgnoreCase" >
					<XPathContent matches="/BusinessProcessData//objectlist/object[@class='111']/@class" replace="FORIS.ScenarioProcessing.CommonUnits.ConditionalDummyResultCreator">
						<Rename matches="^(.+)$" replace="$1_IsModifaed.xml" >
							<File DirPath="C:\temp\2\result" type="copy|replace" append_sub_directories="false"/>
						</Rename>
					</XPathContent>
				</RegexContent>
			</FindFiles>
		</FindDirectories>
	</ScriptTemplate-->
	<!--ScriptTemplate Name="Script2" Severity="debug">
		<FindDirectories DirPath="C:\temp\1" sub_directories="true" matches="q{3,}$">
			<FindFiles sub_directories="true" matches="^(.+)\.\(.*\.xml$">
				<File DirPath="C:\temp\2\result" type="copy|replace" >
					<Rename matches="{FindFiles.matches}" replace="$1.xml" />
				</File>
			</FindFiles>
		</FindDirectories>
		
		
		
	</ScriptTemplate-->

	<!--ScriptTemplate Name="Script2" Severity="console">
		<Timesheet src="https://timesheets.bss.nvision-group.com/surv/_LAYOUTS/WSS/WSSC.CST.SIT.SURV/v2.0.0.0/Tabel.aspx?" fid_start="203" fid_end="262" user_name="bss\vhovanskij" password="July2017"
		export="doc" serialization="true"
        GroupBy="БЕБ[B13001,B13002,B14001,B14002,B14004,B14005];БЕУ[U14040,U14004,U13896,U13921,U13001,U11877,U14045,U81009,U11918,U14002,U14005,U14007,U14689,R84002,U11861,U14043_MNP];БЕУз[R13962,R13016,T14002];БЕР[R14007,R14008,R14036,R29066,T14007];Отпуск и Обучение[I00001,I00003,I00030,I00032,I00132];Остальное[]"

		/>
	</ScriptTemplate-->




	<!--ScriptTemplate Name="Script2" Severity="debug" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<Timesheet src="https://timesheets.bss.nvision-group.com" fid_start="203" fid_end="260" user_name="bss\vhovanskij" password="July2017" >
			<FindValueByRegex>
				<Setting>
					<Item pattern="^.+380696670180.+$" option="IgnoreCase|Multiline" replace="false" reverse_read="false" reserve_lines="0" />
				</Setting>
			</FindValueByRegex>
		</Timesheet>
	</ScriptTemplate-->

	<!--ScriptTemplate Name="timesheet" Severity="debug" log_DirPath="{localpath}\log\LogPattern_{ScriptTemplate.Name}_{datetime,'yyyyMMddhhmmss'}.log">
		<Site src="https://timesheets.bss.nvision-group.com/surv/_layouts/WSS/WSSC.CST.SIT.SURV/v2.0.0.0/Tabel.aspx?fid=216" user_name="bss\vhovanskij" password="July2017" >
			<GetValueByRegex pattern=".*(&lt;div class=&quot;SIT_TAB_tbldivsrl&quot;.+?&lt;/div&gt;).*" option="IgnoreCase|Multiline" >
				<GetValueByRegex pattern="&lt;br&gt;" replacement="" option="IgnoreCase|Multiline" >
					<GetValueByRegex pattern="&lt;img(.+?)&gt;" replacement="&lt;img$1/&gt;" option="IgnoreCase|Multiline" >
						<GetValueByXPath>
							<Settings>
								<Item  />
							</Settings>
						</GetValueByXPath>
					</GetValueByRegex>
				</GetValueByRegex>
			</GetValueByRegex>
		</Site>
	</ScriptTemplate-->

</Config>