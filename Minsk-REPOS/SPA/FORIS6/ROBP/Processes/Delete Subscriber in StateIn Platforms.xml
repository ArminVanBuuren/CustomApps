<BusinessProcessData name="Delete Subscriber in StateIn Platforms" successOnNoOperation="true">
  <businessprocess>
    <scenario>
      <objectlist>
        <object name="BPMProcessingUnit" class="FORIS.ServiceProvisioning.BPM.BPMProcessingUnit" assembly="FORIS.SPA.BPMProcessingUnit.dll" />
        <object name="SplitForVirtualTD" class="FORIS.ScenarioProcessing.CommonUnits.IfMultipleXmlConditionsResolver" assembly="FORIS.SPA.SPF.dll" />
        <object name="DummyForVirtualTD" class="FORIS.ScenarioProcessing.CommonUnits.ConditionalDummyResultCreator" assembly="FORIS.SPA.SPF.dll" />
        <object name="DeleteSubscriberOnDB" class="FORIS.ServiceProvisioning.BPM.BPMProcessingUnit" assembly="FORIS.SPA.BPMProcessingUnit.dll" />
        <object name="DeleteSubscriberVPOonDB" class="FORIS.ServiceProvisioning.BPM.BPMProcessingUnit" assembly="FORIS.SPA.BPMProcessingUnit.dll" />
        <object name="SCProcessingUnit" class="FORIS.ServiceProvisioning.BPM.SCProcessingUnit" assembly="FORIS.SPA.BPMProcessingUnit.dll" />
      </objectlist>
      <automat>
        <node name="SCProcessingUnit" object="SCProcessingUnit">
          <parameterslist />
          <resultlist>
            <result value="" node="DeleteSubscriberOnFINPlatform" />
          </resultlist>
        </node>
        <!-- сценарий сам умеет пропускать виртуальные ПО, но при этом его надо вызывать для удаления ЛС-->
        <node name="DeleteSubscriberOnFINPlatform" object="BPMProcessingUnit">
          <parameterslist>
            <param name="operation" value="DeleteSubscriberOnFINPlatform" />
          </parameterslist>
          <resultlist>
            <result value="" node="Check-VirtualTD" />
          </resultlist>
        </node>
        <!-- пропускаем действия на фин.платформе для виртуального ПО -->
        <node name="Check-VirtualTD" object="SplitForVirtualTD">
          <parameterslist>
            <param name="ObjectNameInContext" value="$XmlRequest" />
            <param name="IfXmlPath:0" value="ExtendedRequestMessage/AdditionalData/DeviceInfo/TerminalDeviceType[starts-with(.,'virtual')]" />
          </parameterslist>
          <resultlist>
            <result value="0" node="DeleteMsisdnFromCampaign" />
            <result value="" node="DeleteRegisteredCUGInFP" />
          </resultlist>
        </node>
        <node name="DeleteRegisteredCUGInFP" object="BPMProcessingUnit">
          <parameterslist>
            <param name="operation" value="DeleteRegisteredCUGInFP" />
          </parameterslist>
          <resultlist>
            <result value="" node="Remove FavoriteNumbers" />
          </resultlist>
        </node>
        <node name="Remove FavoriteNumbers" object="BPMProcessingUnit">
          <parameterslist>
            <param name="operation" value="RemoveFavoriteNumbersOnFP" />
          </parameterslist>
          <resultlist>
            <result value="" node="DeleteMsisdnFromCampaign" />
          </resultlist>
        </node>
        <node name="DeleteMsisdnFromCampaign" object="BPMProcessingUnit">
          <parameterslist>
            <param name="operation" value="DeleteMsisdnFromCampaign" />
          </parameterslist>
          <resultlist>
            <result value="" node="" />
          </resultlist>
        </node>
      </automat>
    </scenario>
  </businessprocess>
</BusinessProcessData>