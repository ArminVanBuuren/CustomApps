<?xml version="1.0" encoding="UTF-8"?>
<Command Name="SC.ChangeTariff.Lite" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Description>ChangeTPOnFINPlatform</Description>
  <Author Name="Victor Kosonogov" Date="2017-05-01+01:01"/>
  <Properties GenerationType="DataSetXml" />
  <Request>
    <RequestTemplate>
      <![CDATA[<DataSet Name="ChangeTariffPlanDataSet" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Attributes>
    <Attribute Name="Label" Type="System.String" Value="ChangeTariffPlanAndServices;##datetime##;[SCP_MARKER]"/>
    <Attribute Name="Protocol" Type="System.String" Value="Msmq"/>
  </Attributes>
  <DataTable Name="ChangeTariffPlanDataTable">
    <Columns>
      <Column Name="REQUEST_ID" Type="System.String"/>
      <Column Name="TERMINAL_DEVICE_CONTRACT_ID" Type="System.Int64"/>
      <Column Name="PERSONAL_ACCOUNT_ID" Type="System.Int64"/>
      <Column Name="OLD_TARIFF_PLAN_ID" Type="System.Int32"/>
      <Column Name="NEW_TARIFF_PLAN_ID" Type="System.Int32"/>
      <Column Name="CLIENT_ID" Type="System.String"/>
      <Column Name="TERMINAL_DEVICE_CLASS" Type="System.Int32"/>
    </Columns>
    <Rows>
      <Row REQUEST_ID="##ASYNC_REQUEST_ID##" TERMINAL_DEVICE_CONTRACT_ID="##TerminalDeviceID##" PERSONAL_ACCOUNT_ID="##PersonalAccount##" 
           OLD_TARIFF_PLAN_ID="##OLD_TARIFF_PLAN_ID##" NEW_TARIFF_PLAN_ID="##NEW_TARIFF_PLAN_ID##" TERMINAL_DEVICE_CLASS="##SC.NEW_TERMINAL_DEVICE_CLASS##" CLIENT_ID="[SCP_MARKER]"/>
    </Rows>
  </DataTable>
  <DataTable Name="ServiceCodeDataTable">
    <Columns>
      <Column Name="SERVICE_ROW_ID" Type="System.Int64"/>
      <Column Name="REQUEST_ID" Type="System.String"/>
      <Column Name="TERMINAL_DEVICE_CONTRACT_ID" Type="System.Int64"/>
      <Column Name="SERVICE_CODE" Type="System.String"/>
      <Column Name="DATE_FROM" Type="System.DateTime"/>
      <Column Name="DATE_TO" Type="System.DateTime"/>
      <Column Name="COUNTER_COEFFICIENT" Type="System.Decimal"/>
      <Column Name="DISCOUNT_TYPE" Type="System.Decimal"/>
      <Column Name="DISCOUNT_VALUE" Type="System.String"/>
    </Columns>
    <Rows>##RegisteredServices####FavoriteNumbersServices##</Rows>
  </DataTable>
  <DataTable Name="ServiceParameters">
    <Columns>
      <Column Name="SERVICE_ROW_ID" Type="System.Int64"/>
      <Column Name="PARAM_CODE" Type="System.String"/>
      <Column Name="PARAM_VALUE" Type="System.String"/>
    </Columns>
    <Rows>##RegisteredServicesParams##</Rows>
  </DataTable> 
<DataTable Name="FnFDataTable">
	<Columns>
		<Column Name="REQUEST_ID" Type="System.String"/>
		<Column Name="TERMINAL_DEVICE_CONTRACT_ID" Type="System.Int64"/>
		<Column Name="FNF_NUMBER" Type="System.String"/>
		<Column Name="FNF_POSITION" Type="System.Int32"/>
		<Column Name="EXTENDED_SERVICE_CODE" Type="System.String"/>
		<Column Name="ACTION" Type="System.Int32"/>
	</Columns>
	<Rows>##FnFServices##</Rows>
</DataTable>
</DataSet>]]>
    </RequestTemplate>
    <EmulationPrintoutTemplate><![CDATA[]]></EmulationPrintoutTemplate>
    <Item Name="datetime" Type="Wellknown"/>
    <Item Name="TerminalDeviceID" Type="Wellknown"/>
    <Item Name="PersonalAccount" Type="Wellknown"/>
    <Item Name="OLD_TARIFF_PLAN_ID" Type="LocalParameter"/>
    <Item Name="NEW_TARIFF_PLAN_ID" Type="LocalParameter"/>
    <Item Name="SC.NEW_TERMINAL_DEVICE_CLASS" Type="Parameter"/>
    <Item Name="RegisteredServices" Type="LocalDynamicParameter"/>
    <Item Name="RegisteredServicesParams" Type="LocalDynamicParameter"/>
    <Item Name="FavoriteNumbersServices" Type="LocalDynamicParameter"/>
    <Item Name="FnFServices" Type="LocalDynamicParameter"/>
  </Request>
  <ParametersList>
    <Parameter Name="OLD_TARIFF_PLAN_ID">
      <Source Path="//AdditionalData//ChangeTP/PreviousTariffPlanId"/>
    </Parameter>
    <Parameter Name="NEW_TARIFF_PLAN_ID">
      <Source Path="//AdditionalData//ChangeTP/NewTariffPlanId"/>
    </Parameter>
  </ParametersList>
  <DynamicParametersList>
    <DynamicParameter Name="RegisteredServices">
      <Source Path="//string"/>
      <DynamicObject Name="RegisteredServices" SkipMissed="True"/>
    </DynamicParameter>
    <DynamicParameter Name="RegisteredServicesParams">
      <Source Path="//string"/>
      <DynamicObject Name="RegisteredServicesParams" SkipMissed="True"/>
    </DynamicParameter>
    <DynamicParameter Name="FavoriteNumbersServices">
      <Source Path="//string"/>
      <DynamicObject Name="FavoriteNumbersServices" SkipMissed="True"/>
    </DynamicParameter>
    <DynamicParameter Name="FnFServices">
      <Source Path="//string"/>
      <DynamicObject Name="FnFServices" SkipMissed="True"/>
    </DynamicParameter>
  </DynamicParametersList>
  <ErrorsList CodePage="ascii"/>
</Command>
