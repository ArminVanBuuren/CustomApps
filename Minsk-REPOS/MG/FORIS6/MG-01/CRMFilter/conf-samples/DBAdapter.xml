<plugin name="DBAdapter">
	<Connections>
    <Handler name="db" type="ForisDataAccess" connectionString="FORISOS_MG"/>
    <Handler name="fda" type="ForisDataAccess" forisDataKey="CRM" />
		<Handler name="srv" type="Remoting" connectionString="tcp://localhost:1234/Test.tcp" interfaceDll="General.dll" />
	</Connections>
	<ThreadPooling use="true" forwarding="true" minThreads="32" />
	<Procedures>
		
		<Procedure	cond="/Message/@type='retrievecustomerdata' and /Message/Item/@subject='balance'" 
					call="API.test_get_balance"
					using="db" >
			
			<Parameters>
				<param name="p_balance"  type="out:string" value="" />
				<param name="p_disconnection_time" type="out:datetime" value="" />				
				<param name="p_phone" type="integer" value="${customer}" />
			</Parameters>
			
			<SendTemplate>
				<Message type="retrievecustomerdataresult" id="@{newGuid}" session_id="${session_id}" request_id="${id}">
					<Item customer="${customer}" state="active" dbresult="0">
						<Attribute name="balanceintpartdotpart" value="${p_balance}" />
						<Attribute name="discontime" value="${p_disconnection_time}" />
					</Item>
				</Message>
			</SendTemplate>
		</Procedure>

<!-- -->		
		<Procedure cond="1=1"
					call = "Sample1_General.ITestRemoting.ReturnInt"
					using = "srv" >
			<Parameters>
				<param name="p_inparam" type="integer" value="${customer}" />
				<param name="p_outparam" type="integer" value="0" />
			</Parameters>
			
			<SendTemplate>
				<Message type="customerdataresult" id="@{newGuid}" session_id="${session_id}" request_id="${id}">
					<Item customer="${customer}" state="active" dbresult="0">
						<Attribute name="outparam" value="${p_outparam}" />
					</Item>
				</Message>
			</SendTemplate>
		</Procedure>
		
	</Procedures>
</plugin>
