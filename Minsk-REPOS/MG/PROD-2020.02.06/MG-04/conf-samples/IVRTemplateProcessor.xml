<templates connector="IVR">

  <template procedureName="INER_proc" inerBcsm="0xC8">
     <input />
     <output spc="0x022">
<!-- in INER we use INParameters which should be specified with nameByte -->         
         <param name="SubId" nameByte="34" type="3" value="2" />
         <param name="Subscriber" nameByte="5" type="1" value="" />
         <param name="SubscriberTime" nameByte="35" type="1" value="" />
         <param name="QueueID" nameByte="7" type="8" value="1" />
         <param name="QType" nameByte="36" type="2" value="2" />
         <param name="OperatorPhone" nameByte="6" type="1" value="" />
<!-- this CallProperties has special type 133 -->
         <param name="CallProperties" type="133" value="256" />
     </output>
  </template>
  
  <template procedureName="DB_LangSetting"> <!--obsolete-->
    <receiveTemplate>
      <Message type="setprofile" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" >
          <Attribute name="communicationlanguage" value="${communicationlanguage}"/>     
        </Item>
      </Message>
    </receiveTemplate>
    <deliveryTemplate>
    </deliveryTemplate>
    <input>
      <param name="customer" />
      <param name="communicationlanguage" />      
    </input>
    <output>
    </output>
 </template>
   
 <template procedureName="DB_LastPeriodBill">
    <receiveTemplate>
        <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
           <Item customer="${customer}" subject="lastperiodbill" />
           <Attribute name="startdate" value="${startdate}" />
           <Attribute name="enddate" value="${enddate}" />
        </Message>
    </receiveTemplate>
    <input>
      <param name="customer" />      
    </input>
    <output>
      <param name="draftintdotpart" type="3" value="0" />
      <param name="beginday" type="1" value="" />
      <param name="endday" type="1" value="" />
    </output>
 </template>
 
 <template procedureName="DB_CustomerCategoryRetriev">
    <receiveTemplate>
        <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
           <Item customer="${customer}" subject="category" />
        </Message>
    </receiveTemplate>
    <input>
      <param name="customer" />      
    </input>
    <output>
      <param name="customercategory" type="2" value="0" />
      <param name="clientstatus" type="3" value="0" />
      <param name="personalaccounttype" type="3" value="0" />
    </output>
 </template>

 <template procedureName="DB_AverageSpendingsRetriev">
    <receiveTemplate>
        <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
           <Item customer="${customer}" subject="averagespendings" />
        </Message>
    </receiveTemplate>
    <input>
      <param name="customer" />      
    </input>
    <output>
      <param name="speedintpartdotpart" type="3" value="0" />
    </output>
 </template>


  <template procedureName="DB_FaxUpdating">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="setprofile" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Attribute name="faxnumber" value="${faxnumber}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="faxnumber" />
    </input>
    <output>
    </output>
  </template>

  <template procedureName="DB_FavUpdate">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="setprofile" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" action="${action}">
          <Attribute name="favouritenumber" value="${favouritenumber}" />
          <Attribute name="index" value="${index}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="index" />
      <param name="action" />
      <param name="favouritenumber" />
    </input>
    <output>
      <param name="favouritenumber" type="1" value="" />
      <param name="count" type="3" value="0" />

     <!-- <param name="chargedamount" type="3" value="0" /> -->
    </output>
  </template>

  <template procedureName="DB_CAuthentication">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="authenticationrequest" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" pin="${password}" />
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="password" />
    </input>
    <output>
      <param name="TariffPlan" type="3" value="0" />
      <param name="State" type="2" value="0" />
      <param name="regioncode" type="3" value="0" />
    </output>
  </template>

  
  <template procedureName="DB_ProcessDate">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="internal" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" action="${action}">
          <Attribute name="startdate" value="${startdate}" />
          <Attribute name="enddate" value="${enddate}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="action" />
      <param name="startdate" />
      <param name="enddate" />
    </input>
    <output>
      <param name="startdate" type="1" value="" />
      <param name="enddate" type="1" value="" />
    </output>
  </template>

 <template procedureName="DB_BalanceRetriev">
  <input>
   <param name="Customer"/>
  </input>
  <output>
 <param name="balanceintpartdotpart"     type="3" value="0"/>
   <param name="DisconnectionTime"         type="3" value="0"/> 
   <param name="recommendedprepayment"     type="3" value="0"/>  
   <param name="accumulator"               type="3" value="0" />
  </output>
  <receiveTemplate>
   <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
    <Item customer="${customer}" subject="balance" />
   </Message>
  </receiveTemplate>
  
 </template>

  <template procedureName="DB_KEOAuthorisation">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="keoactivation" action="5">
            <Attribute name="keonumber" value="${keonumber}" />
          </Service>
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="keonumber" />
    </input>
    <output>
      <param name="allowed" type="2" value="0" />
      <param name="amount" type="3" value="0" />
     <!-- <param name="enddate" type="1" value="" /> -->
    </output>
  </template>

  <template procedureName="DB_SInterrogation">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceinterrogation" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${service}" action="interrogation" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="service" />
    </input>
    <output>
      <param name="Allowed" type="2" value="0" />
      <param name="Subscription" type="2" value="0" />
      <param name="Status" type="2" value="0" />
      <param name="Class" type="3" value="0" />
      <param name="ChargedAmount" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_PassChange">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="setprofile" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Attribute name="oldpassword" value="${password}" />
          <Attribute name="newpassword" value="${newpassword}" />
          <Attribute name="confirmpassword" value="${confirmpassword}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="password" />
      <param name="newpassword" />
      <param name="confirmpassword" />
    </input>
    <output>
      <param name="newpassword" type="1" value="" />
    </output>
  </template>

  <template procedureName="DB_SProcessing">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${service}" action="${action}" class="${class}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="service" />
      <param name="class" />
      <param name="action" />
    </input>
    <output>
      <param name="Subscription" type="2" value="0" />
      <param name="Status" type="2" value="0" />
      <param name="ISCharged" type="2" value="0" />
    </output>
  </template>

  <template procedureName="DB_CCPayments">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="creditcardpayment" action="5">
            <Attribute name="amount" value="${amount}" />
          </Service>
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="amount" />
    </input>
    <output>
      <param name="allowed" type="2" value="0" />
      <param name="amount" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_FaxRetriev">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="retrieveinfo" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" subject="faxnumber" />
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
    </input>
    <output>
      <param name="assigned" type="2" value="0" />
      <param name="faxnumber" type="1" value="" />
    </output>
  </template>

  <template procedureName="dbAdd">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" subject="balance" />
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="Customer" />
      <param name="Param2" />
    </input>
    <output>
    </output>
  </template>

  <template procedureName="DB_CValidation" persistent="false">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="verificationrequest" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" />
      </Message>
    </receiveTemplate>

    <input>
      <param name="customer" />
    </input>
    <output>
      <param name="TariffPlan" type="3" value="0" />
      <param name="State" type="2" value="0" />
      <param name="Password" type="1" value="" />
      <param name="regioncode" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_BillsRetriev">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" subject="bills">
          <Attribute name="index" value="${index}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="index" />
    </input>
    <output>
      <param name="count" type="3" value="0" />
      <param name="begindate" type="1" value="" />
      <param name="enddate" type="1" value="" />
    </output>
  </template>

  
  <template procedureName="DB_PaymentRetriev">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="retrievecustomerdata" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" subject="payments">
          <Attribute name="index" value="${index}" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="index" />
    </input>
    <output>
      <param name="count" type="3" value="0" />
      <param name="day" type="4" value="" />
      <param name="currency" type="3" value="0" />
      <param name="intpartfracpart" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_CustomerBlock">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="blockphone" action="4">
            <Attribute name="state" value="${action}" />
            <Attribute name="start" value="${start}" />
            <Attribute name="end" value="${end}" />
          </Service>
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="start" />
      <param name="end" />
      <param name="action" />
    </input>
    <output>
      <param name="state" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_ExchangeRate">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="retrieveinfo" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" subject="currencyrate" />
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
    </input>
    <output>
      <param name="rateintpartdotpart" type="3" value="0" />
    </output>
  </template>

  <template procedureName="VM_CRM_SETLANGUAGE">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="InvokeResult" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item request_id="${requestId}">
          <Result paremeter1="0" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="ResultCode" />
    </input>
    <output>
      <param name="Subscriber" type="1" value="" />
      <param name="Language" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_PrepaymentBill">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="otprepaymentbill" action="4">
            <Attribute name="faxnumber" value="${faxnumber}" />
            <Attribute name="amountintpartdotpart" value="${amountintpartdotpart}" />
          </Service>
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="amountintpartdotpart" />
      <param name="faxnumber" />
    </input>
    <output>
    </output>
  </template>
  
   <template procedureName="DB_PayVerification">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="guaranteedpayment" action="6" />
        </Item>
    </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
    </input>
    <output>
    <param name="allowed" type="2" value="0" />
    <param name="pending" type="2" value="0" />
    <param name="maximumusd" type="3" value="0" />
    <param name="maximumrur" type="3" value="0" />
    </output>
  </template>

  <template procedureName="DB_PayAcceptance">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
 <Item customer="${customer}">
   <Service id="guaranteedpayment" action="7">
     <Attribute name="amount" value="${amount}" />
     <Attribute name="currency" value="${currency}" />
   </Service>
 </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="currency" />
      <param name="amount" />
    </input>
    <output>
    </output>
  </template>

  <template procedureName="DB_GrInterrogation">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="groupinterrogation" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service id="${groupcode}" action="interrogation" />
        </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="customer" />
      <param name="groupcode" />
    </input>
    <output>
      <param name="service_id" type="3" value="0" />
    </output>
  </template>


  <template procedureName="DB_PRequest">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="serviceorder" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}">
          <Service action="4" id="@{switch(${Service}|???,10|otdetailedbill,11|otbillviafax,12|otdetailedbalance,13|otprepaymentbill)}">
    <Attribute name="start" value="${start}" />
    <Attribute name="end" value="${end}" />
    <Attribute name="faxnumber" value="${faxnumber}" />
          </Service>
 </Item>
      </Message>
    </receiveTemplate>
    
    <input>
      <param name="Customer" />
      <param name="Service" />
      <param name="Start" />
      <param name="End" />
      <param name="FaxNumber" />
    </input>
    <output>
    </output>
  </template>
  
  <template procedureName="ServiceTypeTest" persistent="false">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="verificationrequest" initiator="ivrcon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${customer}" />
      </Message>
    </receiveTemplate>

    <input>
      <param name="customer" />
    </input>
    <output>
      <param name="TariffPlan" type="9" value="test2" />
      <param name="State" type="2" value="0" />
      <param name="Password" type="1" value="" />
      <param name="regioncode" type="3" value="0" />
    </output>
  </template>
  
  
  <template procedureName="SendPriceSMS">
    <condition>
    </condition>
    <receiveTemplate>
      <Message type="deliveryrequest" initiator="smscon" id="${guid}" session_id="@{newGuid}">
        <Item customer="${recipient}" sender="${sender}">
          <Content encoding="7bit" charset="iso-8859-2">${content}</Content>
        </Item>
      </Message>
    </receiveTemplate>
    
     <deliveryTemplate direction="input" terminating="false">
		  <set item="param:dbresult" value="0" />
     </deliveryTemplate>
     
     <deliveryTemplate direction="input" connector="SMSCON_01">
     </deliveryTemplate>
    
    <input>
      <param name="anumber" />
      <param name="sender" />
      <param name="content" />
      <param name="recipient" />
    </input>
    
    <output>
      <param name="dbresult" type="3" value="0"/>	
    </output>
  </template>


</templates>
